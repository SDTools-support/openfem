/* emaq2c.f -- translated by f2c (version 19961017).
   You must link the resulting object file with the libraries:
	-lf2c -lm   (in that order)
*/

#include "f2c.h"
#include "../mex/of_def.h"

/* Table of constant values */

static int32 c__9 = 9;

/* Subroutine */ int emaq2c_(n, r__, z__, rho, ae)
int32 *n;
doublereal *r__, *z__, *rho, *ae;
{
    /* Initialized data */

    static doublereal poidsg[9] = { .30864197530864201,.49382716049382713,.30864197530864201,.49382716049382713,.79012345679012341,.49382716049382713,.30864197530864201,.49382716049382713,.30864197530864201 };
    static doublereal p[81]	/* was [9][9] */ = { .4723790007724451,-.060000000000000004,.0076209992275549851,-.060000000000000004,.27491933384829669,-.034919333848296665,-.034919333848296665,.27491933384829669,.15999999999999997,0.,0.,0.,0.,.68729833462074174,0.,-.087298334620741685,0.,.39999999999999996,-.060000000000000004,.4723790007724451,-.060000000000000004,.0076209992275549851,.27491933384829669,.27491933384829669,-.034919333848296665,-.034919333848296665,.15999999999999997,0.,0.,0.,
	    0.,0.,-.087298334620741685,0.,.68729833462074174,.39999999999999996,0.,0.,0.,0.,0.,0.,0.,0.,1.,0.,0.,0.,0.,0.,.68729833462074174,0.,-.087298334620741685,.39999999999999996,-.060000000000000004,.0076209992275549851,-.060000000000000004,.4723790007724451,-.034919333848296665,-.034919333848296665,.27491933384829669,.27491933384829669,.15999999999999997,0.,0.,0.,0.,-.087298334620741685,0.,.68729833462074174,0.,.39999999999999996,.0076209992275549851,-.060000000000000004,.4723790007724451,
	    -.060000000000000004,-.034919333848296665,.27491933384829669,.27491933384829669,-.034919333848296665,.15999999999999997 };
    static doublereal dp[162]	/* was [2][9][9] */ = { -.87602816808281591,-.87602816808281591,-.18872983346207417,.11127016653792583,.023971831917184147,.023971831917184147,.11127016653792583,-.18872983346207417,1.0647580015448903,-.50983866769659336,-.10983866769659336,-.13524199845510997,-.13524199845510997,-.10983866769659336,-.50983866769659336,1.0647580015448903,.6196773353931867,.6196773353931867,-.34364916731037087,0.,.34364916731037087,0.,-.043649167310370842,0.,.043649167310370842,0.,
	    0.,-1.2745966692414834,.19999999999999998,0.,0.,-.2745966692414834,-.19999999999999998,0.,0.,1.5491933384829668,.18872983346207417,.11127016653792583,.87602816808281591,-.87602816808281591,-.11127016653792583,-.18872983346207417,-.023971831917184147,.023971831917184147,-1.0647580015448903,-.50983866769659336,.50983866769659336,1.0647580015448903,.13524199845510997,-.10983866769659336,.10983866769659336,-.13524199845510997,-.6196773353931867,.6196773353931867,0.,-.34364916731037087,0.,
	    .043649167310370842,0.,-.043649167310370842,0.,.34364916731037087,0.,-.19999999999999998,-.2745966692414834,0.,0.,.19999999999999998,-1.2745966692414834,0.,1.5491933384829668,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,-.5,.5,0.,0.,.5,-.5,0.,0.,0.,0.,.043649167310370842,0.,-.34364916731037087,0.,.34364916731037087,0.,-.043649167310370842,0.,-.19999999999999998,1.2745966692414834,0.,0.,.19999999999999998,.2745966692414834,0.,-1.5491933384829668,0.,.11127016653792583,.18872983346207417,
	    .023971831917184147,-.023971831917184147,-.18872983346207417,-.11127016653792583,-.87602816808281591,.87602816808281591,-.13524199845510997,.10983866769659336,-.10983866769659336,.13524199845510997,1.0647580015448903,.50983866769659336,-.50983866769659336,-1.0647580015448903,.6196773353931867,-.6196773353931867,.043649167310370842,0.,-.043649167310370842,0.,.34364916731037087,0.,-.34364916731037087,0.,0.,.2745966692414834,.19999999999999998,0.,0.,1.2745966692414834,
	    -.19999999999999998,0.,0.,-1.5491933384829668,-.023971831917184147,-.023971831917184147,-.11127016653792583,.18872983346207417,.87602816808281591,.87602816808281591,.18872983346207417,-.11127016653792583,.13524199845510997,.10983866769659336,.50983866769659336,-1.0647580015448903,-1.0647580015448903,.50983866769659336,.10983866769659336,.13524199845510997,-.6196773353931867,-.6196773353931867 };
    static doublereal pi = 3.14159265358979;

    /* System generated locals */
    doublereal d__1;

    /* Local variables */
    static doublereal coef;
    static int32 i__;
    static doublereal poids, f1[9], f2[9], p1, p2, p3, p4, p5, p6, p7, p8, p9, dfm1dp[162]	/* was [2][9][9] */;
    extern /* Subroutine */ int dpaq2c_();
    static doublereal poidel[9];

/* *************************************************************** */
/* BUT : CALCUL DE LA MATRICE DE MASSE DE L ELEMENT QUAD AQ2C */
/* --- */
/* IN : */
/*      N           : Nb ondes circonferentielles */
/*      R(9) , Z(9) : Coordonnees des sommets de l'element courant */
/*      Rho  : masse volumique */
/* OUT: matrice de rigidite AE. Cf ERAQ2C pour mode de stockage. */
/* ....................................................................... */
/*  PROGRAMMEUR :  A.Hassim */
/* ....................................................................... */
/*     -- XYNPI: coordonnees pt. int. numeriques (element reference) */
    /* Parameter adjustments */
    --ae;
    --z__;
    --r__;

    /* Function Body */
/*     -- POIDSG: poids du schema d'integration numerique. */
/*     -- Valeurs des Polynomes de base aux pt. int. numerique. */
/*     -- Valeurs Derive'es des Poly. de base aux pt int. numerique. */


/*     Calcul de [DF]  ; [DF] * [DP] ; ... */

    dpaq2c_(&r__[1], &z__[1], &c__9, &c__9, poidsg, p, dp, f1, f2, dfm1dp, poidel);

/*     INITIALISATION DE AE: -> AZEROD(1,1,378,AE) */
/*     -------------------- */
    for (i__ = 1; i__ <= 378; ++i__) {
	ae[i__] = 0.;
/* L1: */
    }

    if (*n == 0) {
	coef = pi * 2.;
    } else {
	coef = pi;
    }
    for (i__ = 1; i__ <= 9; ++i__) {
	poids = coef * *rho * poidel[i__ - 1];
	p1 = p[i__ * 9 - 9];
	p2 = p[i__ * 9 - 8];
	p3 = p[i__ * 9 - 7];
	p4 = p[i__ * 9 - 6];
	p5 = p[i__ * 9 - 5];
	p6 = p[i__ * 9 - 4];
	p7 = p[i__ * 9 - 3];
	p8 = p[i__ * 9 - 2];
	p9 = p[i__ * 9 - 1];
/* Computing 2nd power */
	d__1 = p1;
	ae[1] += poids * (d__1 * d__1);
/* Computing 2nd power */
	d__1 = p1;
	ae[3] += poids * (d__1 * d__1);
/* Computing 2nd power */
	d__1 = p1;
	ae[6] += poids * (d__1 * d__1);
	ae[7] += poids * p1 * p2;
/* Computing 2nd power */
	d__1 = p2;
	ae[10] += poids * (d__1 * d__1);
	ae[12] += poids * p1 * p2;
/* Computing 2nd power */
	d__1 = p2;
	ae[15] += poids * (d__1 * d__1);
	ae[18] += poids * p1 * p2;
/* Computing 2nd power */
	d__1 = p2;
	ae[21] += poids * (d__1 * d__1);
	ae[22] += poids * p1 * p3;
	ae[25] += poids * p2 * p3;
/* Computing 2nd power */
	d__1 = p3;
	ae[28] += poids * (d__1 * d__1);
	ae[30] += poids * p1 * p3;
	ae[33] += poids * p2 * p3;
/* Computing 2nd power */
	d__1 = p3;
	ae[36] += poids * (d__1 * d__1);
	ae[39] += poids * p1 * p3;
	ae[42] += poids * p2 * p3;
/* Computing 2nd power */
	d__1 = p3;
	ae[45] += poids * (d__1 * d__1);
	ae[46] += poids * p1 * p4;
	ae[49] += poids * p2 * p4;
	ae[52] += poids * p3 * p4;
/* Computing 2nd power */
	d__1 = p4;
	ae[55] += poids * (d__1 * d__1);
	ae[57] += poids * p1 * p4;
	ae[60] += poids * p2 * p4;
	ae[63] += poids * p3 * p4;
/* Computing 2nd power */
	d__1 = p4;
	ae[66] += poids * (d__1 * d__1);
	ae[69] += poids * p1 * p4;
	ae[72] += poids * p2 * p4;
	ae[75] += poids * p3 * p4;
/* Computing 2nd power */
	d__1 = p4;
	ae[78] += poids * (d__1 * d__1);
	ae[79] += poids * p1 * p5;
	ae[82] += poids * p2 * p5;
	ae[85] += poids * p3 * p5;
	ae[88] += poids * p4 * p5;
/* Computing 2nd power */
	d__1 = p5;
	ae[91] += poids * (d__1 * d__1);
	ae[93] += poids * p1 * p5;
	ae[96] += poids * p2 * p5;
	ae[99] += poids * p3 * p5;
	ae[102] += poids * p4 * p5;
/* Computing 2nd power */
	d__1 = p5;
	ae[105] += poids * (d__1 * d__1);
	ae[108] += poids * p1 * p5;
	ae[111] += poids * p2 * p5;
	ae[114] += poids * p3 * p5;
	ae[117] += poids * p4 * p5;
/* Computing 2nd power */
	d__1 = p5;
	ae[120] += poids * (d__1 * d__1);
	ae[121] += poids * p1 * p6;
	ae[124] += poids * p2 * p6;
	ae[127] += poids * p3 * p6;
	ae[130] += poids * p4 * p6;
	ae[133] += poids * p5 * p6;
/* Computing 2nd power */
	d__1 = p6;
	ae[136] += poids * (d__1 * d__1);
	ae[138] += poids * p1 * p6;
	ae[141] += poids * p2 * p6;
	ae[144] += poids * p3 * p6;
	ae[147] += poids * p4 * p6;
	ae[150] += poids * p5 * p6;
/* Computing 2nd power */
	d__1 = p6;
	ae[153] += poids * (d__1 * d__1);
	ae[156] += poids * p1 * p6;
	ae[159] += poids * p2 * p6;
	ae[162] += poids * p3 * p6;
	ae[165] += poids * p4 * p6;
	ae[168] += poids * p5 * p6;
/* Computing 2nd power */
	d__1 = p6;
	ae[171] += poids * (d__1 * d__1);
	ae[172] += poids * p1 * p7;
	ae[175] += poids * p2 * p7;
	ae[178] += poids * p3 * p7;
	ae[181] += poids * p4 * p7;
	ae[184] += poids * p5 * p7;
	ae[187] += poids * p6 * p7;
/* Computing 2nd power */
	d__1 = p7;
	ae[190] += poids * (d__1 * d__1);
	ae[192] += poids * p1 * p7;
	ae[195] += poids * p2 * p7;
	ae[198] += poids * p3 * p7;
	ae[201] += poids * p4 * p7;
	ae[204] += poids * p5 * p7;
	ae[207] += poids * p6 * p7;
/* Computing 2nd power */
	d__1 = p7;
	ae[210] += poids * (d__1 * d__1);
	ae[213] += poids * p1 * p7;
	ae[216] += poids * p2 * p7;
	ae[219] += poids * p3 * p7;
	ae[222] += poids * p4 * p7;
	ae[225] += poids * p5 * p7;
	ae[228] += poids * p6 * p7;
/* Computing 2nd power */
	d__1 = p7;
	ae[231] += poids * (d__1 * d__1);
	ae[232] += poids * p1 * p8;
	ae[235] += poids * p2 * p8;
	ae[238] += poids * p3 * p8;
	ae[241] += poids * p4 * p8;
	ae[244] += poids * p5 * p8;
	ae[247] += poids * p6 * p8;
	ae[250] += poids * p7 * p8;
/* Computing 2nd power */
	d__1 = p8;
	ae[253] += poids * (d__1 * d__1);
	ae[255] += poids * p1 * p8;
	ae[258] += poids * p2 * p8;
	ae[261] += poids * p3 * p8;
	ae[264] += poids * p4 * p8;
	ae[267] += poids * p5 * p8;
	ae[270] += poids * p6 * p8;
	ae[273] += poids * p7 * p8;
/* Computing 2nd power */
	d__1 = p8;
	ae[276] += poids * (d__1 * d__1);
	ae[279] += poids * p1 * p8;
	ae[282] += poids * p2 * p8;
	ae[285] += poids * p3 * p8;
	ae[288] += poids * p4 * p8;
	ae[291] += poids * p5 * p8;
	ae[294] += poids * p6 * p8;
	ae[297] += poids * p7 * p8;
/* Computing 2nd power */
	d__1 = p8;
	ae[300] += poids * (d__1 * d__1);
	ae[301] += poids * p1 * p9;
	ae[304] += poids * p2 * p9;
	ae[307] += poids * p3 * p9;
	ae[310] += poids * p4 * p9;
	ae[313] += poids * p5 * p9;
	ae[316] += poids * p6 * p9;
	ae[319] += poids * p7 * p9;
	ae[322] += poids * p8 * p9;
/* Computing 2nd power */
	d__1 = p9;
	ae[325] += poids * (d__1 * d__1);
	ae[327] += poids * p1 * p9;
	ae[330] += poids * p2 * p9;
	ae[333] += poids * p3 * p9;
	ae[336] += poids * p4 * p9;
	ae[339] += poids * p5 * p9;
	ae[342] += poids * p6 * p9;
	ae[345] += poids * p7 * p9;
	ae[348] += poids * p8 * p9;
/* Computing 2nd power */
	d__1 = p9;
	ae[351] += poids * (d__1 * d__1);
	ae[354] += poids * p1 * p9;
	ae[357] += poids * p2 * p9;
	ae[360] += poids * p3 * p9;
	ae[363] += poids * p4 * p9;
	ae[366] += poids * p5 * p9;
	ae[369] += poids * p6 * p9;
	ae[372] += poids * p7 * p9;
	ae[375] += poids * p8 * p9;
/* Computing 2nd power */
	d__1 = p9;
	ae[378] += poids * (d__1 * d__1);

/* L2: */
    }
} /* emaq2c_ */


/* ets3p2c.f -- translated by f2c (version 19961017).
   You must link the resulting object file with the libraries:
	-lf2c -lm   (in that order)
*/

#include "f2c.h"
#include "../mex/of_def.h"

/* Table of constant values */

static int32 c__10 = 10;
static int32 c__4 = 4;
static int32 c__6 = 6;
static int32 c__15 = 15;
static int32 c__7 = 7;

/* Subroutine */ int ets3p2c_(coor, volf, sur, pres, noref, be)
doublereal *coor, *volf, *sur, *pres;
int32 *noref;
doublereal *be;
{
    /* Initialized data */

    static doublereal poisms[7] = { .0629695902724136,.0629695902724136,.0629695902724136,.0661970763942531,.0661970763942531,.0661970763942531,.112499997019768 };
    static int32 nloc[24]	/* was [6][4] */ = { 1,3,2,7,6,5,1,4,3,8,10,7,1,2,4,5,9,8,2,3,4,6,10,9 };
    static doublereal vp[150]	/* was [10][15] */ = { -.125,-.125,-.125,-.125,.25,.25,.25,.25,.25,.25,.324516523092734,-.0750537196563629,-.0750537196563629,-.0750537196563629,.266380161832731,.0338347167927203,.266380161832731,.266380161832731,.0338347167927203,.0338347167927203,-.075053719656363,.324516523092734,-.0750537196563629,-.0750537196563629,.266380161832731,.266380161832731,.0338347167927203,.0338347167927203,.266380161832731,.0338347167927203,-.0750537196563627,-.0750537196563629,
	    .324516523092734,-.0750537196563629,.0338347167927203,.266380161832731,.266380161832731,.0338347167927203,.0338347167927203,.266380161832731,-.0750537196563627,-.0750537196563629,-.0750537196563629,.324516523092734,.0338347167927203,.0338347167927203,.0338347167927203,.266380161832731,.266380161832731,.266380161832731,-.0373192912588241,-.115257699028758,-.115257699028758,-.115257699028758,.0519589385132896,.409071857601743,.0519589385132896,.0519589385132896,.409071857601743,
	    .409071857601743,-.115257699028758,-.0373192912588239,-.115257699028758,-.115257699028758,.0519589385132895,.0519589385132894,.409071857601743,.409071857601743,.0519589385132894,.409071857601743,-.115257699028758,-.115257699028758,-.0373192912588239,-.115257699028758,.409071857601743,.0519589385132894,.0519589385132895,.409071857601743,.409071857601743,.0519589385132894,-.115257699028758,-.115257699028758,-.115257699028758,-.0373192912588239,.409071857601743,.409071857601743,
	    .409071857601743,.0519589385132895,.0519589385132894,.0519589385132894,-.05,-.05,-.05,-.05,.0127016653792583,.1,.1,.1,.1,.787298334620742,-.05,-.05,-.05,-.05,.1,.0127016653792583,.1,.787298334620742,.1,.1,-.0500000000000001,-.05,-.05,-.05,.787298334620742,.1,.1,.1,.1,.0127016653792583,-.0499999999999999,-.05,-.05,-.05,.0999999999999999,.787298334620742,.0999999999999999,.0127016653792583,.1,.1,-.05,-.05,-.05,-.05,.1,.1,.0127016653792583,.1,.787298334620742,.1,-.05,-.05,-.05,-.05,.1,
	    .1,.787298334620742,.1,.0127016653792583,.1 };
    static doublereal poids[15] = { .0197530873119831,.0119895139631698,.0119895139631698,.0119895139631698,.0119895139631698,.0115113678710454,.0115113678710454,.0115113678710454,.0115113678710454,.00881834235042334,.00881834235042334,.00881834235042334,.00881834235042334,.00881834235042334,.00881834235042334 };
    static doublereal vdpsq1[84]	/* was [2][6][7] */ = { -2.18970794141235,-2.18970794141235,-.594853970706175,0.,0.,-.594853970706175,2.78456191211852,-.405146029293825,.405146029293825,.405146029293825,-.405146029293825,2.78456191211852,.594853970706174,.594853970706174,2.18970794141235,0.,0.,-.594853970706175,-2.78456191211852,-3.18970794141235,.405146029293825,3.18970794141235,-.405146029293825,0.,.594853970706174,.594853970706174,-.594853970706175,0.,0.,2.18970794141235,0.,
	    -.405146029293825,3.18970794141235,.405146029293825,-3.18970794141235,-2.78456191211852,-.880568256420461,-.880568256420461,.88056825642046,0.,0.,-.761136512840921,0.,-1.88056825642046,.238863487159079,1.88056825642046,-.238863487159079,1.64170476926138,.76113651284092,.76113651284092,.88056825642046,0.,0.,.88056825642046,-1.64170476926138,-1.88056825642046,1.88056825642046,1.88056825642046,-1.88056825642046,-1.64170476926138,-.880568256420461,-.880568256420461,-.761136512840921,0.,
	    0.,.88056825642046,1.64170476926138,-.238863487159079,1.88056825642046,.238863487159079,-1.88056825642046,0.,-.333333253860474,-.333333253860474,.333333373069763,0.,0.,.333333373069763,-1.19209289550781e-7,-1.33333337306976,1.33333337306976,1.33333337306976,-1.33333337306976,-1.19209289550781e-7 };
    static doublereal vps[42]	/* was [6][7] */ = { .474352608585539,-.0807685941918872,-.0807685941918872,.323074376767549,.0410358262631383,.323074376767549,-.080768594191887,.474352608585538,-.0807685941918872,.323074376767549,.323074376767549,.0410358262631383,-.080768594191887,-.0807685941918872,.474352608585538,.0410358262631383,.323074376767549,.323074376767549,-.0280749432230788,-.0280749432230789,-.0525839011025453,.884134241764073,.112299772892315,.112299772892315,-.0525839011025456,
	    -.0280749432230789,-.0280749432230789,.112299772892315,.884134241764072,.112299772892315,-.0280749432230788,-.0525839011025453,-.0280749432230789,.112299772892315,.112299772892315,.884134241764073,-.111111117733849,-.111111107799742,-.111111107799742,.444444431198967,.444444470935398,.444444431198967 };
    static struct {
	doublereal e_1[450];
	} equiv_2 = { 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -1., -1., 1., 1., 0., -1., 0., -1., -1., -1., 0., 1., 0., 1., 0., 1., 1., -1.89634706336732, -1.89634706336732, -1.89634706336732, -.632115687789108, 0., 0., 0., -.632115687789108, 0., 0., 0., -.632115687789108, 2.52846275115643, -.367884312210892, -.367884312210892, .367884312210892, .367884312210892, 0., -.367884312210892, 2.52846275115643, -.367884312210892, -.367884312210892, -.367884312210892, 2.52846275115643, 
		.367884312210892, 0., .367884312210892, 0., .367884312210892, .367884312210892, .632115687789108, .632115687789108, .632115687789108, 1.89634706336732, 0., 0., 0., -.632115687789108, 0., 0., 0., -.632115687789108, -2.52846275115643, -2.89634706336732, -2.89634706336732, .367884312210892, 2.89634706336732, 0., -.367884312210892, 0., -.367884312210892, -.367884312210892, -.367884312210892, 0., .367884312210892, 0., 2.89634706336732, 0., .367884312210892, .367884312210892, 
		.632115687789108, .632115687789108, .632115687789108, -.632115687789108, 0., 0., 0., 1.89634706336732, 0., 0., 0., -.632115687789108, 0., -.367884312210892, -.367884312210892, 2.89634706336732, .367884312210892, 0., -2.89634706336732, -2.52846275115643, -2.89634706336732, -.367884312210892, -.367884312210892, 0., .367884312210892, 0., .367884312210892, 0., .367884312210892, 2.89634706336732, .632115687789108, .632115687789108, .632115687789108, -.632115687789108, 0., 0., 0., 
		-.632115687789108, 0., 0., 0., 1.89634706336732, 0., -.367884312210892, -.367884312210892, .367884312210892, .367884312210892, 0., -.367884312210892, 0., -.367884312210892, -2.89634706336732, -2.89634706336732, -2.52846275115643, 2.89634706336732, 0., .367884312210892, 0., 2.89634706336732, .367884312210892, .837523533955559, .837523533955559, .837523533955559, .27917451131852, 0., 0., 0., .27917451131852, 0., 0., 0., .27917451131852, -1.11669804527408, -1.27917451131852, 
		-1.27917451131852, 1.27917451131852, 1.27917451131852, 0., -1.27917451131852, -1.11669804527408, -1.27917451131852, -1.27917451131852, -1.27917451131852, -1.11669804527408, 1.27917451131852, 0., 1.27917451131852, 0., 1.27917451131852, 1.27917451131852, -.27917451131852, -.27917451131852, -.27917451131852, -.837523533955559, 0., 0., 0., .27917451131852, 0., 0., 0., .27917451131852, 1.11669804527408, -.162476466044441, -.162476466044441, 1.27917451131852, .162476466044441, 0., 
		-1.27917451131852, 0., -1.27917451131852, -1.27917451131852, -1.27917451131852, 0., 1.27917451131852, 0., .162476466044441, 0., 1.27917451131852, 1.27917451131852, -.27917451131852, -.27917451131852, -.27917451131852, .27917451131852, 0., 0., 0., -.837523533955559, 0., 0., 0., .27917451131852, 0., -1.27917451131852, -1.27917451131852, .162476466044441, 1.27917451131852, 0., -.162476466044441, 1.11669804527408, -.162476466044441, -1.27917451131852, -1.27917451131852, 0., 
		1.27917451131852, 0., 1.27917451131852, 0., 1.27917451131852, .162476466044441, -.27917451131852, -.27917451131852, -.27917451131852, .27917451131852, 0., 0., 0., .27917451131852, 0., 0., 0., -.837523533955559, 0., -1.27917451131852, -1.27917451131852, 1.27917451131852, 1.27917451131852, 0., -1.27917451131852, 0., -1.27917451131852, -.162476466044441, -.162476466044441, 1.11669804527408, .162476466044441, 0., 1.27917451131852, 0., .162476466044441, 1.27917451131852, 
		.774596669241483, .774596669241483, .774596669241483, -.774596669241483, 0., 0., 0., .774596669241483, 0., 0., 0., .774596669241483, 0., -.225403330758517, -.225403330758517, 1.77459666924148, .225403330758517, 0., -1.77459666924148, -1.54919333848297, -1.77459666924148, -1.77459666924148, -1.77459666924148, -1.54919333848297, 1.77459666924148, 0., .225403330758517, 0., 1.77459666924148, 1.77459666924148, -.774596669241483, -.774596669241483, -.774596669241483, -.774596669241483, 
		0., 0., 0., -.774596669241483, 0., 0., 0., .774596669241483, 1.54919333848297, -.225403330758517, -.225403330758517, .225403330758517, .225403330758517, 0., -.225403330758517, 1.54919333848297, -.225403330758517, -1.77459666924148, -1.77459666924148, 0., 1.77459666924148, 0., .225403330758517, 0., 1.77459666924148, .225403330758517, -.774596669241483, -.774596669241483, -.774596669241483, .774596669241483, 0., 0., 0., -.774596669241483, 0., 0., 0., -.774596669241483, 0., 
		-1.77459666924148, -1.77459666924148, .225403330758517, 1.77459666924148, 0., -.225403330758517, 1.54919333848297, -.225403330758517, -.225403330758517, -.225403330758517, 1.54919333848297, .225403330758517, 0., 1.77459666924148, 0., .225403330758517, .225403330758517, .774596669241483, .774596669241483, .774596669241483, .774596669241483, 0., 0., 0., .774596669241483, 0., 0., 0., -.774596669241483, -1.54919333848297, -1.77459666924148, -1.77459666924148, 1.77459666924148, 
		1.77459666924148, 0., -1.77459666924148, -1.54919333848297, -1.77459666924148, -.225403330758517, -.225403330758517, 0., .225403330758517, 0., 1.77459666924148, 0., .225403330758517, 1.77459666924148, .774596669241483, .774596669241483, .774596669241483, .774596669241483, 0., 0., 0., -.774596669241483, 0., 0., 0., .774596669241483, -1.54919333848297, -1.77459666924148, -1.77459666924148, .225403330758517, 1.77459666924148, 0., -.225403330758517, 0., -.225403330758517, 
		-1.77459666924148, -1.77459666924148, -1.54919333848297, 1.77459666924148, 0., 1.77459666924148, 0., 1.77459666924148, .225403330758517, -.774596669241483, -.774596669241483, -.774596669241483, -.774596669241483, 0., 0., 0., .774596669241483, 0., 0., 0., -.774596669241483, 1.54919333848297, -.225403330758517, -.225403330758517, 1.77459666924148, .225403330758517, 0., -1.77459666924148, 0., -1.77459666924148, -.225403330758517, -.225403330758517, 1.54919333848297, .225403330758517,
		 0., .225403330758517, 0., .225403330758517, 1.77459666924148 };


    /* Local variables */
#define vdpq2 ((doublereal *)&equiv_2)
    extern /* Subroutine */ int es3c2c_();
    static doublereal delta[15], delts[7];
#define dp1 ((doublereal *)&equiv_2)
#define dp2 ((doublereal *)&equiv_2 + 150)
#define dp3 ((doublereal *)&equiv_2 + 300)

/* +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ */
/*                  S.P. ES3P1D */
/*                  ------------ */
/* +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ */
/*  BUT   : CALCUL DU SECOND MEMBRE ELEMENTAIRE ELASTIQUE */
/*  ---      TETRAEDRE P1 DROIT  . */

/*  PARAMETRES D ENTREE  : */
/*  ------------------- */
/*   X,Y,Z   : COORDONNEES DES POINTS DE L ELEMENT (SIMPLE PRECISION) */
/*   VOLF    : FORCES VOLUMIQUES */
/*   NOREF   : noref(nbface,2) avec nbface = nombre de faces */
/*             noref(i,1) =/ 0 si face i soumise force surfacique */
/*             noref(2,1) =/ 0 si face i soumise a pression */
/*   SUR     : efforts surfaciques */
/*   pres    : pression */
/*  PARAMETRE DE SORTIE  : */
/*  -------------------- */
/*   BE      : TABLEAU DES SECONDS MEMBRES */

/* +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ */
/*  PROGRAMMEUR  : Marina Vidrascu 2001 */
/* ................................................................... */

    /* Parameter adjustments */
    --be;
    noref -= 5;
    pres -= 7;
    sur -= 22;
    volf -= 4;
    coor -= 11;

    /* Function Body */

    es3c2c_(&c__10, &c__10, &c__4, &c__6, &c__6, &noref[5], &c__15, poids, &c__7, poisms, nloc, &coor[11], &coor[21], &coor[31], &volf[4], &sur[22], &pres[7], vp, vp, vdpq2, vdpq2, vdpsq1, vps, vps, &be[1], delts, delta);
} /* ets3p2c_ */

#undef dp3
#undef dp2
#undef dp1
#undef vdpq2



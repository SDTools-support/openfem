/* etc3q2c.f -- translated by f2c (version 19961017).
   You must link the resulting object file with the libraries:
	-lf2c -lm   (in that order)
*/

#include "f2c.h"
#include "../mex/of_def.h"

/* Table of constant values */

static int32 c__20 = 20;

/* Subroutine */ int etc3q2c_(coor, car, iopt, sigma, u)
doublereal *coor, *car;
int32 *iopt;
doublereal *sigma, *u;
{
    /* Initialized data */

    static int32 ijt[60] = { 1,4,7,10,13,16,19,22,25,28,31,34,37,40,43,46,49,52,55,58,2,5,8,11,14,17,20,23,26,29,32,35,38,41,44,47,50,53,56,59,3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60 };
    static struct {
	doublereal e_1[1200];
	} equiv_1 = { -1.5, -1.5, -1.5, -.5, 0., 0., 0., 0., 0., 0., -.5, 0., 0., 0., -.5, 0., 0., 0., 0., 0., 0., 0., 0., 0., 2., 0., 0., 0., 0., 0., 0., 0., 0., 0., 2., 0., 0., 0., 2., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., .5, 0., 0., 1.5, -1.5, -1.5, 0., -.5, 0., 0., 0., 0., 0., 0., 0., 0., 0., -.5, 0., 0., 0., 0., 0., 0., -2., 0., 0., 0., 2., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 2., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 
		0., 0., 0., 0., 0., 0., 0., 0., 0., .5, 0., 1.5, 1.5, -1.5, .5, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -.5, 0., 0., 0., 0., 0., 0., 0., -2., 0., -2., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 2., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., .5, 0., 0., 0., 0., .5, 0., 0., -1.5, 1.5, -1.5, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -.5, 0., 0., 0., 0., 0., 0., 2., 0., 0., 0., -2., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 2., 0., 0., 0., 0., 0.,
		 0., 0., 0., 0., 0., 0., 0., 0., 0., .5, 0., 0., 0., 0., 0., 0., 0., 0., 0., -1.5, -1.5, 1.5, -.5, 0., 0., 0., 0., 0., 0., -.5, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -2., 0., 0., 0., 0., 0., 0., 0., 0., 0., 2., 0., 0., 0., 0., 0., 0., 0., 0., 0., 2., 0., 0., 0., 0., 0., 0., .5, 0., 0., 0., 0., 0., 0., .5, 0., 0., 1.5, -1.5, 1.5, 0., -.5, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -2., 0., 0., 0., 0., 0., 0., -2., 0., 
		0., 0., 2., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., .5, 0., 0., 0., 0., 0., 0., 0., .5, 0., 1.5, 1.5, 1.5, .5, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -2., 0., 0., 0., 0., 0., 0., 0., -2., 0., -2., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., .5, 0., .5, 0., 0., 0., 0., .5, 0., 0., -1.5, 1.5, 1.5, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -2., 
		0., 0., 0., 0., 0., 0., 2., 0., 0., 0., -2., 0., -.5, -.5, -.5, .5, -.5, -.5, 0., -.5, 0., 0., -.5, 0., 0., 0., -.5, 0., 0., -.5, 0., 0., 0., 0., 0., 0., 0., -.5, -.5, 0., 1., 0., 0., .5, 0., 0., 1., 0., 0., 0., 1., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., .5, 0., 0., 0., 0., 0., 0., 0., 0., 0., .5, 0., 0., .5, -.5, -.5, .5, .5, -.5, .5, 0., 0., 0., 0., 0., 0., 0., -.5, 0., 0., -.5, 0., 0., 0., -1., 0., 0., .5, 0., -.5, -1., 0., 0., .5, 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 
		1., 0., 0., 0., 0., 0., 0., 0., 0., .5, 0., 0., 0., 0., 0., 0., 0., .5, 0., 0., .5, 0., .5, .5, -.5, .5, .5, -.5, 0., 0., 0., 0., 0., 0., 0., 0., -.5, 0., 0., -.5, 0., -.5, 0., 0., -1., 0., 0., .5, -.5, 0., -1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., .5, 0., 0., 0., -.5, -.5, -.5, .5, 0., 0., -.5, 0., 0., -.5, .5, -.5, 0., 0., -.5, 0., 0., 0., 0., 0., 0., 0., 0., -.5, 1., 0., 0., .5, 0., 0., 1., 0., 0., -.5, 0., -.5, 0., 0., 1., 0., 0.,
		 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., .5, -.5, -.5, -.5, -.5, 0., 0., 0., 0., 0., 0., -.5, 0., -.5, -.5, .5, .5, 0., 0., 0., 0., 0., 0., -.5, 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., -.5, -.5, 0., .5, 0., 0., 0., 0., 0., 0., .5, 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., .5, 0., 0., .5, -.5, -.5, 0., -.5, 0., 0., 0., 0., .5, 0., 0., .5, -.5, .5, 0., -.5, 0., 0., 0., 0., -1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., .5, 0., 
		0., .5, -.5, 0., 0., .5, 0., 0., 0., 0., -1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., .5, 0., .5, .5, -.5, .5, 0., 0., 0., 0., 0., 0., .5, 0., .5, .5, .5, .5, 0., 0., 0., 0., 0., 0., -1., 0., -1., 0., 0., 0., 0., 0., 0., 0., 0., 0., -.5, 0., .5, .5, 0., -.5, 0., 0., 0., 0., 0., 0., -1., 0., -1., 0., 0., 0., 0., 0., 0., .5, 0., 0., 0., 0., .5, 0., 0., -.5, .5, -.5, 0., .5, 0., 0., 0., 0., -.5, 0., 0., -.5, .5, .5, 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., -1., 0.,
		 0., -.5, 0., 0., 0., 0., .5, 0., 0., -.5, .5, 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., -1., 0., 0., 0., .5, 0., 0., .5, 0., 0., 0., 0., 0., 0., -.5, -.5, .5, .5, -.5, .5, 0., -.5, 0., 0., -.5, 0., 0., 0., -.5, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -1., 0., 0., -1., 0., 0., 0., 0., 0., 0., 0., -.5, .5, 0., 1., 0., 0., .5, 0., 0., 1., 0., 0., 0., 0., 0., 0., .5, 0., 0., .5, 0., 0., 0., .5, 0., 0., .5, -.5, .5, .5, .5, .5, .5, 0., 0., 0., 0., 0., 0., 0., -.5, 0., 0., 0., 
		0., 0., 0., 0., 0., 0., 0., 0., -1., 0., 0., -1., 0., 0., 0., -1., 0., 0., .5, 0., .5, -1., 0., 0., .5, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., .5, 0., 0., .5, 0., .5, 0., 0., .5, 0., .5, .5, .5, -.5, .5, .5, 0., 0., 0., 0., 0., 0., 0., 0., -.5, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -1., 0., 0., -1., 0., -.5, 0., 0., -1., 0., 0., .5, .5, 0., -1., 0., 0., 0., .5, 0., 0., 0., 0., 0., 0., 0., 0., .5, -.5, -.5, .5, -.5, 0., 0., .5, 0., 0., -.5, .5, .5, 0., 0., 0., 0., 0., 0., 
		0., 0., 0., 0., 0., -.5, 0., 0., -1., 0., 0., 0., 0., 0., 0., 0., 0., -1., 1., 0., 0., .5, 0., 0., 1., 0., 0., -.5, 0., .5 };


    /* Local variables */
    static doublereal elas[9];
    extern /* Subroutine */ int ec3c2c_();
    static doublereal delta[20], a2[1200]	/* was [3][20][20] */;
#define dp ((doublereal *)&equiv_1)
    static doublereal sigmae[7200]	/* was [6][60][20] */;
#define dp1 ((doublereal *)&equiv_1)
#define dp2 ((doublereal *)&equiv_1 + 600)

/* +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ */
/*  BUT   : CALCUL DES CONTRAINTES aux 27 points de Gauss */
/*  ---     Hexaedre Q2 ISOPARAMETRIQUE */


/*  PARAMETRES D ENTREE  : */
/*  ------------------- */
/*   X,Y,Z   : TABLEAUX DES COORDONNEES DES POINTS DE L ELEMENT */
/*   ijt     : permutation pour oasser de la numerotation par inconnues */
/*             a celle par noeuds */
/*   nno     : nombre de noeuds de l'element */
/*   npo     : nombre de points */
/*   npi     : nombre de points d'integration */
/*   dp      : valeur des derivees des polynomes de base aux points */
/*             d'integration sur l'element de reference */
/*   vp1     : valeur des polynomes de base aux points */
/*             d'integration sur l'element de reference */
/*   poids   : poids de la formule d'integration */

/*  tableaux de travail : */
/*  ------------------- */
/*   delta   : jacobien aux points d'integration */
/*   (x y z)int : coordonnees des points d'integration sur */
/*              l'element courant */

/*  PARAMETRE DE SORTIE  : */
/*  -------------------- */
/*   sigma          : contraintes */

/* +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ */
/*  PROGRAMMEURS  : Marina Vidrascu 2003 */
/* ................................................................... */

/*     --- > casser le data dp pour ne pas avoir trop de cartes suite */
    /* Parameter adjustments */
    coor -= 21;
    --car;
    sigma -= 7;
    --u;

    /* Function Body */

/*     si isotrope e=car(1), nu=car(2) */
/*     si orthotrope elas=car */
    if (*iopt == 2) {

/*         CAS ISOTROPE */
/*         ------------ */
	ec3c2c_(&c__20, &c__20, &coor[21], &coor[41], &coor[61], ijt, dp, dp, iopt, &car[1], &car[2], elas, sigmae, &sigma[7], &u[1], delta, a2);
    } else {

/*         CAS ORTHOTROPE */
/*         -------------- */
	ec3c2c_(&c__20, &c__20, &coor[21], &coor[41], &coor[61], ijt, dp, dp, iopt, &car[1], &car[2], &car[1], sigmae, &sigma[7], &u[1], delta, a2);
    }
} /* etc3q2c_ */

#undef dp2
#undef dp1
#undef dp



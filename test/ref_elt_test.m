%$Revision: 1.33 $  $Date: 2022/06/24 12:35:35 $
% Elts tests with SDT5.1

 st={'q4p','q8p','t3p','t6p',...
     'hexa8','hexa20','penta6','penta15',...
     'tetra4','tetra10','tria3','tria6',...
     'quad4','quadb','quad9','bar1','flui4',...
     'flui6','flui8','beam1'};
 % missing: mitc4, , beam3, , celas , q5p, q9a ,'dktp',

Eig_ref(:,1)={...
    '[model,def]=q4p(''testeig_0'');'
    '[model,def]=q4p(''testeig_1'');'
    '[model,def]=q4p(''testeig_2'');'
    '[model,def]=q8p(''testeig_0'');'
    '[model,def]=q8p(''testeig_1'');'
    '[model,def]=q8p(''testeig_2'');'
    '[model,def]=t3p(''testeig_0'');'
    '[model,def]=t3p(''testeig_1'');'
    '[model,def]=t3p(''testeig_2'');'
    '[model,def]=t6p(''testeig_0'');'
    '[model,def]=t6p(''testeig_1'');'
    '[model,def]=t6p(''testeig_2'');'
    '[model,def]=q4pb(''testeig_0'');'
    '[model,def]=q4pb(''testeig_1'');'
    '[model,def]=q8pb(''testeig_0'');'
    '[model,def]=q8pb(''testeig_1'');'
    '[model,def]=t3pb(''testeig_0'');'
    '[model,def]=t3pb(''testeig_1'');'
    '[model,def]=t6pb(''testeig_0'');'
    '[model,def]=t6pb(''testeig_1'');'
    '[model,def]=hexa8(''testeig'');'
    '[model,def]=hexa20(''testeig'');'
    '[model,def]=penta6(''testeig'');'
    '[model,def]=penta15(''testeig'');'
    '[model,def]=tetra4(''testeig'');'
    '[model,def]=tetra10(''testeig'');'
    '[model,def]=hexa8b(''testeig'');'
    '[model,def]=hexa20b(''testeig'');'
    '[model,def]=penta6b(''testeig'');'
    '[model,def]=penta15b(''testeig'');'
    '[model,def]=tetra4b(''testeig'');'
    '[model,def]=tetra10b(''testeig'');'
    '[model,def]=tria3(''testeig'');'
    '[model,def]=tria6(''testeig'');'
    '[model,def]=quad4(''testeig'');'
    '[model,def]=quad4(''testeig_1'');'
    '[model,def]=quad4(''testeig_2'');'
    '[model,def]=quad4(''testeig_5'');'
    '[model,def]=quadb(''testeig'');'
    '[model,def]=quad9(''testeig'');'
    '[model,def]=bar1(''testeig'');'
    '[model,def]=flui4(''testeig'');'
    '[model,def]=flui6(''testeig'');'
    '[model,def]=flui8(''testeig'');'
    '[model,def]=beam1(''testeig'');'
    '[model,def]=beam1t(''testeig'');'
    '[model,def]=pyra5(''testeig'');'
    '[model,def]=pyra13(''testeig'');'
};
%sprintf('%.14f ',def.data(1:5))
Eig_ref(:,2)={ % 5 first frequencies
[ 443.7706010572511 1088.653082748253 1263.970138487206 2325.882876793439 2638.396871201627 ] %q4p
[ 429.0291308356455 1029.468636991386 1231.61770377086 2243.426897960299 2623.009060844697 ] 
[ 283.5082346183173 1360.097168396428 1508.703856371114 2379.287034382513 2751.065553564581 ] 
[ 426.9985368359902 1080.858864997452 1249.488010001295 2252.360962856316 2625.908024601863 ] %q8p
[ 414.2427945181661 1026.807469917145 1220.302297159397 2184.430056407338 2611.028503198023 ] 
[ 250.0168473280123 1301.096887774772 1498.560728422033 2279.178130368977 2561.839242296919 ] 
[ 446.4359686432878 1092.472465577848 1311.136686059801 2528.855801347858 2786.125474338813 ] %t3p
[ 432.0148932501078 1033.057952114468 1277.577946848218 2442.645647105107 2726.387923856738 ] 
[ 285.0669809048732 1387.151305108699 1518.582239890267 2617.763700247233 2827.890195429798 ] 
[ 426.9456708071043 1080.868312982486 1250.432819230386 2255.749795908762 2628.358994865547 ] %t6p
[ 414.2816502365748 1026.830998717467 1221.167244359762 2187.347803795076 2613.84784913695 ] 
[  249.74428847566 1301.23240758954 1498.716081626339 2281.683507824629 2563.126164146328 ] 
[ 433.404144262734 1087.191984973834 1277.351820629235 2358.278526075213 2757.038989449751 ]  %q4pb
[ 419.7549983015216 1030.660241913355 1246.746942123562 2278.754080184619  2671.3297473047 ] 
[ 426.9985368359752 1080.858864997454 1249.488010001302 2252.360962856318 2625.908024601862 ] %q8pb
[ 414.242794518208 1026.807469917152 1220.302297159413 2184.430056407337 2611.028503198028 ] 
[ 446.4359686432892 1092.472465577848 1311.136686059802 2528.855801347856 2786.12547433881 ]  %t3pb
[ 432.0148932501094 1033.057952114469 1277.577946848218 2442.645647105108 2726.38792385674 ] 
[ 426.9456708068987 1080.868312982296 1250.432819230057 2255.749795907628 2628.358994862551 ] %t6pb
[ 414.2816502363858 1026.830998717344 1221.167244359452 2187.347803794072 2613.847849134099 ] 

[237.6033888792544 444.2083897305652 444.7269848190954 1085.22752065936 1363.472428758497  ] %hexa8
[201.0116614786637 412.5729063295417 423.4415084207131 1059.702559650887 1116.580150430465 ] %hexa20
[226.6279732285614 446.2131048899014 482.8627353643082 1071.551694132552 1300.554395204275 ] %penta
[199.7390631376445 410.8441731316861 420.9361829911879 1057.184208102395 1103.626968128397 ]
[236.01760155135938 438.97496762132482 493.54747464662563 1066.73573439164690 1205.21018576195090] %tetra4 4/1/8 change in fe_mat G and mat selection
[199.51432702485650 410.22875897410108 420.69932430696605 1056.93425112250450 1100.73792470112650] %tetra10 4/1/8 change in fe_mat G and mat selection
[237.6033888792544 444.2083897305652 444.7269848190954 1085.22752065936 1363.472428758497  ] %hexa8b
[201.0116614786637 412.5729063295417 423.4415084207131 1059.702559650887 1116.580150430465 ]
[226.6279732285614 446.2131048899014 482.8627353643082 1071.551694132552 1300.554395204275 ] %penta
[199.7390631376445 410.8441731316861 420.9361829911879 1057.184208102395 1103.626968128397 ]
[239.11714476074246 444.40862313929006 517.41035962049955 1073.66758320053650 1337.79867595448040 ] %tetra % differs from tetra4 because of mass
[199.51432703965418 410.22875901486850 420.69932433827444 1056.93425115560560 1100.73792475696040 ]%tetra10 4/1/8 change in fe_mat G and mat selection
[6.270845512244446 16.06767897178608 48.77079711333202 62.35800970677099 68.11733277061069 ] % tria3 (19/5/11) change
%[6.28319135210261  17.82989849869369  49.72552488761478  63.68990750779680  77.10090344400720] %tria3
'error tria6'
%[6.31114275433068  17.96164583556516  52.85870957797935  66.63940321272283  80.85193965771684] %quad4 before change in G handling
[6.30996966170508 15.7059102809775 52.7792129841036 65.1088707802316 70.6812131671887 ] % quad4
%[6.279418502853163e+000    1.777887747984670e+001    4.932011676869890e+001    6.380232643548938e+001    7.691784601500523e+001] % quad4_1 before change in G handling
[6.27801104274853 15.6244722296036 49.2714830243193 62.2664962442876 67.2598114708106 ]% quad4_1
%[ 6.311035889710269e+000    1.796059088189650e+001    5.284989075562687e+001    6.662488652790042e+001    8.083569046659869e+001] % quad4_2 before change in G handling
[6.30986281916857 15.704951972126 52.7703312243128 65.0946412802529 70.6666754028455 ]% quad4_2
%[6.311142754343527e+000    1.796164583557854e+001    5.285870957797744e+001    6.663940321272445e+001    8.085193965771822e+001] % quad4_5 before change in G handling
[6.30996966170508 15.7059102809775 52.7792129841036 65.1088707802316 70.6812131671887 ] % quad4_5
%[6.279510125347771e+000 1.777159655733382e+001 4.945133978014305e+001 6.374728975055643e+001    7.693504846998744e+001] % quadb xxx
[6.28442140650357 15.55431019677425 49.47769845206693 62.30765192510126 67.00240217246832 ] % quadb formulation 2
'error quad9'
[95.08149774942956 332.1369132130657 389.2837237581641 669.5421119323413 1025.205694097194 ] %bar1
%SDT5.1    [1.128916716519793e+003    1.395677509724138e+003    1.395677509724340e+003 ...
%    1.633056209189190e+003    2.108740158389825e+003]
%    [1.151386858774883e+003    1.385892352561525e+003    1.385892352561538e+003 ...
%    1.592071311791083e+003    2.015182364725996e+003]
%    [1.137891192596138e+003    1.382144188142123e+003    1.382144188142126e+003 ...
%    1.589291901269960e+003    2.091034987589612e+003]
[248.1154794667646 305.5482584475449 305.5482584475452 355.810559650365 456.7662671383993] % flui4
[250.3360623711554 302.6140058489737 302.6140058489741 348.5120298030064 445.3095853171215] 
[250.3360623711535 304.0717213912683 304.0717213912693 349.6442182793904 460.0276972697199]
%[5.52871713448861 17.03729745698168 42.89152496798485 64.09678599223149 89.45303284319429] % beam1 5.1
[5.528381947456046 17.02992139800653 42.87231691061424 64.04124208796881 89.44576100792672 ]
[0.07198293146777 0.28793177259620 0.64784694357951 1.15173007641929 1.79958540624573] %beam1t
[244.6448922514838 454.7229837636187 625.6310711574198 1084.138110679918 1383.546276384605 ]%pyra5
[200.3405908696561 411.9744000856454 422.6708560104183 1058.838893699534 1111.131007446405 ]%pyra13
};


Load_ref(:,1)={
    '[model,def]=q4p(''testload_0'');'  
    '[model,def]=q4p(''testload_1'');'  
    '[model,def]=q4p(''testload_2'');'  
    '[model,def]=q8p(''testload_0'');'  
    '[model,def]=q8p(''testload_1'');'  
    '[model,def]=q8p(''testload_2'');'  
    '[model,def]=t3p(''testload_0'');'  
    '[model,def]=t3p(''testload_1'');'  
    '[model,def]=t3p(''testload_2'');'  
    '[model,def]=t6p(''testload_0'');'  
    '[model,def]=t6p(''testload_1'');'  
    '[model,def]=t6p(''testload_2'');'  
    '[model,def]=hexa8(''testload'');'  
    '[model,def]=hexa20(''testload'');' 
    '[model,def]=penta6(''testload'');' 
    '[model,def]=penta15(''testload'');'
    '[model,def]=tetra4(''testload'');' 
    '[model,def]=tetra10(''testload'');'
    '[model,def]=tria3(''testload'');'  
    '[model,def]=tria6(''testload'');'  
    '[model,def]=quad4(''testload'');'  
    '[model,def]=quad4(''testload_1'');'  
    '[model,def]=quad4(''testload_2'');'  
    '[model,def]=quad4(''testload_5'');'  
    '[model,def]=quadb(''testload'');'  
    '[model,def]=quad9(''testload'');'  
    '[model,def]=bar1(''testload'');'   
    '[model,def]=flui4(''testload'');'  
    '[model,def]=flui6(''testload'');'  
    '[model,def]=flui8(''testload'');'  
    '[model,def]=beam1(''testload'');'  
    '[model,def]=q4pb(''testload_0'');'  
    '[model,def]=q4pb(''testload_1'');'  
    '[model,def]=q8pb(''testload_0'');'  
    '[model,def]=q8pb(''testload_1'');'  
    '[model,def]=t3pb(''testload_0'');'  
    '[model,def]=t3pb(''testload_1'');'  
    '[model,def]=t6pb(''testload_0'');'  
    '[model,def]=t6pb(''testload_1'');'  
    '[model,def]=hexa8b(''testload'');'  
    '[model,def]=hexa20b(''testload'');' 
    '[model,def]=penta6b(''testload'');' 
    '[model,def]=penta15b(''testload'');'
    '[model,def]=tetra4b(''testload'');' 
    '[model,def]=tetra10b(''testload'');'
    '[model,def]=fsc3(''testload'');'
    '[model,def]=beam1t(''testload'');'
    '[model,def]=pyra5(''testload'');'
    '[model,def]=pyra13(''testload'');'
};
Load_ref(:,2)={ % norm of rhs (sum)
%2D
[0.1492651754180880       0.2635231383473650       0.2635231383473650  ] % q4p_0
[0.1492651754180880       0.2635231383473650       0.2635231383473650  ]
[0.54159352000617 Inf Inf  ] % do not compare surf load for axi
[0.1568276359810585       0.2115492529406641       0.2115492529406641  ] % q8p_0
[0.1568276359810585       0.2115492529406641       0.2115492529406641  ]
[0.56764852669930 Inf Inf]   % do not compare surf load for axi
[0.1493010694129361       0.2635231383473650       0.2635231383473650  ] % t3p_0
[0.1493010694129361       0.2635231383473650       0.2635231383473650  ]
[0.54065843616630 Inf Inf]   % do not compare surf load for axi
[0.0928237854433492       0.2115492529406641       0.2115492529406641  ] % t6p_0
[0.0928237854433492       0.2115492529406641       0.2115492529406641  ]
[0.33628338122352 Inf Inf]   % do not compare surf load for axi
% 3D
[0.4541666446719321       0.2151657350435289       0.2151657350435289  ] % hexa8
[0.7406202903337038       0.2393120043689214       0.2393120043689202  ]
[0.3582515086533142       0.1563142965034849       0.1563142965034849  ] % penta6
[0.4205295402467210       0.0984272710571236       0.0984272710571231  ]
[0.2880370137727840       0.1563142918449559       0.1563142918449559  ] % tetra4
[0.1468186085980361       0.0984272760420434       0.0984272760420434  ]
[0.01464643490941 Inf Inf] % tria3
    'error tria6'
[0.01464291370851 Inf Inf] % quad4
[1.464291370851444e-002 Inf Inf] % quad4_1
[1.464291370851444e-002 Inf Inf] % quad4_2
[1.464291370851444e-002 Inf Inf] % quad4_5
    'error quadb'
    'error quad9'
    [7.391036260090295e-05] % bar1. Modified 4/1/8 : checked use of .weight
    'error flui4'
    'error flui6'         
    'error flui8'         
    [7.499033124746842e-005] %beam1
[0.1492651754180880 0.2635231383473650 0.2635231383473650  ] % q4pb_0
[0.1492651754180880 0.2635231383473650 0.2635231383473650  ]
[0.1568276359810585 0.2115492529406641 0.2115492529406641  ] % q8pb_0
[0.1568276359810585 0.2115492529406641 0.2115492529406641  ]
[0.1493010694129361 0.2635231383473650 0.2635231383473650  ] % t3pb_0
[0.1493010694129361 0.2635231383473650 0.2635231383473650  ]
[0.0928237854433492 0.2115492529406641 0.2115492529406641  ] % t6pb_0
[0.0928237854433492 0.2115492529406641 0.2115492529406641  ]
[0.4541666446719321 0.2151657350435289 0.2151657350435289  ] % hexa8b
[0.7406202903337038 0.2393120043689214 0.2393120043689202  ]
[0.3582515086533142 0.1563142965034849 0.1563142965034849  ] % penta6b
[0.4203295226115752 0.09842727604204342 0.09842727604204343 ] % penta15b
[0.2880370137727840 0.1563142918449559 0.1563142918449559  ] % tetra4b
[0.1468186085980361 0.0984272760420434 0.0984272760420434  ]
[5.00000000000000 0.07198706042809 560.98275487992657 0.07207577645353] % fsc corrected 27/1/9
%5.000000000000   0.071987060430   5.79988701281136e2   0.072042291932  ] % fsc3
5.10928010577443e-5
[0.3752032435338656 0.2151657414559675 0.2151657414559675 ]%pyra5
[0.314387499240186 0.2182386520190218 0.1257987738586662 ]%pyra13
};

Mat_ref(:,1)={...
    'k=q4p(''testmat_0'');'
    'k=q4p(''testmat_1'');'
    'k=q4p(''testmat_2'');'
    'k=q8p(''testmat_0'');'
    'k=q8p(''testmat_1'');'
    'k=q8p(''testmat_2'');'
    'k=t3p(''testmat_0'');'
    'k=t3p(''testmat_1'');'
    'k=t3p(''testmat_2'');'
    'k=t6p(''testmat_0'');'
    'k=t6p(''testmat_1'');'
    'k=t6p(''testmat_2'');'
    'k=q4pb(''testmat_0'');'
    'k=q4pb(''testmat_1'');'
    'k=q8pb(''testmat_0'');'
    'k=q8pb(''testmat_1'');'
    'k=t3pb(''testmat_0'');'
    'k=t3pb(''testmat_1'');'
    'k=t6pb(''testmat_0'');'
    'k=t6pb(''testmat_1'');'
    'k=hexa8(''testmat'');'
    'k=hexa20(''testmat'');'
    'k=penta6(''testmat'');'
    'k=penta15(''testmat'');'
    'k=tetra4(''testmat'');'
    'k=tetra10(''testmat'');'
    'k=hexa8b(''testmat'');'
    'k=hexa20b(''testmat'');'
    'k=penta6b(''testmat'');'
    'k=penta15b(''testmat'');'
    'k=tetra4b(''testmat'');'
    'k=tetra10b(''testmat'');'
    'k=tria3(''testmat'');'
    'k=tria6(''testmat'');'
    'k=quad4(''testmat'');'
    'k=quad4(''testmat_1'');'
    'k=quad4(''testmat_2'');'
    'k=quad4(''testmat_5'');'
    'k=quadb(''testmat'');'
    'k=quad9(''testmat'');'
    'k=bar1(''testmat'');'
    'k=flui4(''testmat'');'
    'k=flui6(''testmat'');'
    'k=flui8(''testmat'');'
    'k=beam1(''testmat'');'
    'k=beam1t(''testmat'');'
    'k=pyra5(''testmat'');'
    'k=pyra13(''testmat'');'
};
Mat_ref(:,2)={ % First value of svd for K and M
[ 380056103520.0435             1950 ]  % q4p_0
[ 310277271366.7655             1950 ] 
[ 1612161301022.247 6971.94435946967 ] 
[ 1162316292536.501 4216.337962957678 ] % q8p_0
[ 982392367007.8132 4216.337962957678 ] 
[ 6010527746475.594 13734.59194188233 ] 
[ 436845951521.188             1300 ]   % t3p
[ 356013372614.4174             1300 ] 
[ 1272147901026.296 2722.713633111155 ] 
[ 1265663701554.58 1392.418991184935 ]  % t6p
[ 1063787654405.139 1392.418991184935 ] 
[ 4092164186367.988 3199.395317077769 ] 
[380056103520.0435             1950 ] % q4pb_0
[293706293706.2936             1950 ]
[1162316292536.5 4216.337962957678  ] % q8pb_0
[982392367007.8134 4216.337962957678]
[436845951521.1879             1300 ] % t3pb_0
[356013372614.4174             1300 ]
[1265663701497.42 1392.418991171393 ] % t6pb_0
[1063787654356.836 1392.418991171393]
[2.441860355956611e+011    9.749999527819462e+002] % hexa8
[6.330222443973812e+011    3.965718244950989e+003] % hexa20
[2.430028333362581e+011    6.500000042119781e+002] % penta6
[8.514963709996585e+011    1.671081632270233e+003] % penta15
[1.859383657182347e+011    3.250000096857548e+002] % tetra4
[4.307001902768686e+011    3.403025592105917e+002] % tetra10
[ 244186046511.6278 975.0000000000001 ] % hexa8b
[ 633022252857.9233 3965.718100552042 ] % hexa20b
[ 243002826094.2105 650.0000000000001 ] % penta6b
[ 851496373992.1628 1671.081665543223 ] % penta15b
[ 185938360176.8398 324.9999999999999 ] % tetra4b
[ 430700170395.5465 340.3025399681919 ] % tetra10b
    [3.560133726154119e+009    1.381337170886616e+001] % tria3
    'error'                                            % tria6
    [2.937062937062937e+009    1.950000000000000e+001] % quad4
    [2.937062937062937e+009    2.058830428324772e+001] % quad4_1
    [2.937062937062937e+009    1.950000000000000e+001] % quad4_2
    [2.937062937062937e+009    1.950000000000000e+001] % quad4_5
    [5.798967689221895e+009    1.508165308406692e+001] % quadb
    'error'                                            % quad9
    [168000000                               1.560000] % bar1
    [0.46451885202355               0.00000031233797 ] % flui4 (updated in SDT5.3)
    [0.61224489795918                0.00000062467595] % flui6 (updated in SDT5.3)
    [0.40816326530612                0.00000093701392] % flui8 (updated in SDT5.3)
    [168000000,1.60356927924842,3031168043.57977,283.244906285714] % beam1 (prop updated in SDT5.3)
    [168000000,1.60356880580925,3031168043.57977,283.232530285714] % beam1t (prop updated in SDT67)
[231843739776.4237 530.5480479109447 ] % pyra5
[838135146681.5544 1496.826616489729 ] % pyra13
};

% get properties 
pl=[100    4.1164696590949e-001    2.1000000000000e+011 2.8500000000000e-001    7.8000000000000e+003    8.171206225680934e+010
    101    4.1164696590950e-001    1.0000000000000e+003 1.5000000000000e+003       0                         0
    102    4.1164696590950e-001    1.2250000000000e+000 3.3000000000000e+002                         0                         0
    112    4.1164696590949e-001    4.2000000000000e+011 2.8500000000000e-001    1.5600000000000e+004    8.171206225680934e+010];


il=[1.100000000000000e+002    6.200235205300000e-004                         0 0                         0    1.000000000000000e-002 0                         0
    1.130000000000000e+002    6.243722226200000e-004    1.000000000000000e+000 0                         0                         0 0                         0
    1.110000000000000e+002    6.243722226100000e-004                         0 0                         0                         0 0                         0
    1.120000000000000e+002    6.891376690000000e-006    2.666666666666667e-008 1.333333333333334e-008    1.333333333333334e-008    4.000000000000000e-004 0                         0];


                         
                         
                         
    



if 1==2
 for j1=1:length(Mat_ref)
  if isa(Mat_ref{j1,2},'cell')
  [max(svd(Mat_ref{j1,2}{1})) max(svd(Mat_ref{j1,2}{2}))]
  else
   'error'
  end
 end
end %1==2
